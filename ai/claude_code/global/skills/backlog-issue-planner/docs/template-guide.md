# backlog-issue-planner テンプレートガイド

各ファイルのテンプレート構造と記法ルールを定義する。

---

## ブランチ命名規則

| 種別  | パターン                         | 使いどころ                       |
| ----- | -------------------------------- | -------------------------------- |
| feat  | `feat/BUSSW-XXXX-<description>`  | 新機能・新規開発                 |
| fix   | `fix/BUSSW-XXXX-<description>`   | バグ修正・不具合対応             |
| chore | `chore/BUSSW-XXXX-<description>` | 設定変更・整備・リファクタリング |

- `<description>` は英語のkebab-caseで10語以内
- `XXXX` は Backlog 起票後に採番された番号に置き換える

---

## backlog.md テンプレート

> 記法: `../backlog-markdown-formatting/docs/transform-rules.md` に従う（Backlog記法）

### 執筆方針

- **読者**: 非エンジニアを含む全員。プロジェクトオーナー・ビジネスサイドも読む。
- **粒度**: 「何を・なぜ・どうなれば完了か」が伝わればよい。コードの詳細（どのクラスのどのメソッドなど）は不要。
- **技術的記述の基準**:
  - 原則不要。「〇〇機能を追加する」「〇〇のバグを修正する」レベルで十分。
  - バグ対応で明らかにコード起因の場合は簡単に触れてよい。
  - **DB変更は例外**: テーブル・カラム単位の変更は表形式で明示する（後述）。
- **目的**: 要求と設計の認識合わせ・承認の場として機能させる。

```markdown
# [チケットタイトル]

## 対応

（PR作成後に記入する）

<!-- 記入例:
sc_ddl
https://github.com/[org]/sc-sc_ddl/pull/[number]
sc
https://github.com/[org]/sc-sc/pull/[number]
-->

## 概要

[1〜3文で課題・背景を説明する。非エンジニアにも伝わる平易な表現で。]

## やること

- [タスク1（機能・修正の内容を平易な言葉で）]
- [タスク2]
- [タスク3]

## やらないこと（スコープ外）

- [除外項目1]
- [除外項目2]

## DB変更（DB変更がない場合はこのセクションを削除する）

| 変更種別   | テーブル名   | カラム名   | 内容             |
| ---------- | ------------ | ---------- | ---------------- |
| 新規作成   | [テーブル名] | -          | [テーブルの用途] |
| カラム追加 | [テーブル名] | [カラム名] | [型・用途]       |
| カラム変更 | [テーブル名] | [カラム名] | [変更内容]       |
| カラム削除 | [テーブル名] | [カラム名] | [削除理由]       |

## 完了条件

- [ ] [受け入れ条件1（ユーザー視点・動作確認できる粒度で）]
- [ ] [受け入れ条件2]
- [ ] [受け入れ条件3]

## 関連情報

- 関連チケット:
- 参考URL:
- 担当者:
- 優先度:
```

---

## requirements.md テンプレート

> 記法: 標準GFM（`-` 箇条書き・ATX見出し）

### 執筆方針

- **読者**: 実装担当エンジニア。`backlog.md` よりも詳細を書く。
- **粒度**: 実装時の判断基準になる詳細を含める（API仕様・DB設計・エラーケースなど）。
- **目的**: 実装の拠り所となるドキュメント。コードレビュー・テスト設計にも使う。

```markdown
# 要件定義書: [機能名]

> 作成日: YYYY-MM-DD
> ステータス: Draft

## 1. 目的・背景

[なぜこの機能が必要か、解決する課題を記述する]

## 2. スコープ

### 対象

- [含まれる機能・範囲]

### 対象外

- [除外する機能・範囲]

## 3. 機能要件

### 3.1 [機能カテゴリ名]

- **[要件ID]-1**: [要件の説明]
- **[要件ID]-2**: [要件の説明]

## 4. 非機能要件

| 項目           | 要件                                 |
| -------------- | ------------------------------------ |
| パフォーマンス | [例: レスポンスタイム 2秒以内]       |
| セキュリティ   | [例: 認証済みユーザーのみアクセス可] |
| 可用性         | [例: 稼働率 99.9%]                   |

## 5. 前提条件・制約

- [前提条件1]
- [技術的制約1]

## 6. 受け入れ条件

- [ ] [テスト可能な条件1]
- [ ] [テスト可能な条件2]
- [ ] [テスト可能な条件3]

## 7. 用語定義

| 用語   | 定義   |
| ------ | ------ |
| [用語] | [説明] |
```

---

## design.md テンプレート

> 記法: 標準GFM（`-` 箇条書き・ATX見出し）

### 執筆方針

- **読者**: 実装担当エンジニア・AI ツール（Cursor / Windsurf / Codex など）。
- **役割**: 「どう作るか」の技術的意思決定を記録する。`requirements.md`（何を・なぜ）と相互補完する。
- **書くこと**: 人間が設計時に決める情報（アーキテクチャ方針・DB スキーマ詳細・API 設計・制御ルール・実装順）。
- **書かないこと**: 具体的なファイルパスやコード変更（AI がコードベースを探索して決める）。

```markdown
# 技術設計書: [機能名]

> 作成日: YYYY-MM-DD
> 関連チケット: BUSSW-XXXX
> 関連要件定義: requirements.md

## 1. 技術アプローチ

[採用するアーキテクチャ方針・設計パターンと選択理由。複数案があれば却下理由も記載する]

## 2. 影響システム・リポジトリ

| システム / リポジトリ | 変更概要                   | 規模感 |
| --------------------- | -------------------------- | ------ |
| [repo名]              | [変更内容を1行で]          | 大/中/小 |
| [repo名]              | [変更内容を1行で]          | 大/中/小 |

## 3. データモデル設計

> DB変更がない場合はこのセクションを削除する

### 新規テーブル: [テーブル名]

[テーブルの用途・設計意図]

| カラム名   | 論理名   | 型          | NULL | 説明         |
| ---------- | -------- | ----------- | ---- | ------------ |
| id         | ID       | biginteger  | 不可 | 主キー       |
| facility_id | 施設ID  | biginteger  | 不可 | 施設の識別   |
| [カラム名] | [論理名] | [型]        | 可   | [説明]       |

- 共通監査カラム: created, created_user, modified, modified_user, deleted, deleted_user

### 既存テーブル変更: [テーブル名]

| カラム名   | 論理名   | 型     | NULL | 説明   |
| ---------- | -------- | ------ | ---- | ------ |
| [カラム名] | [論理名] | [型]   | 可   | [説明] |

## 4. システム間インターフェース

> 外部サービス連携・システム間 API がない場合はこのセクションを削除する

### 新規・変更 API エンドポイント

| エンドポイント   | メソッド | 概要       |
| ---------------- | -------- | ---------- |
| `/api/[path]`    | POST     | [概要]     |

### 外部サービス連携

[SBペイメントなど外部サービスとの接続方式・認証方式・戻り先URLのパターンなど]

## 5. ビジネスロジック・制御ルール

[実装時に判断が必要なルール・エッジケース・計算ロジック。ここを読めば実装の意図が分かるように書く]

- [ルール1]
- [ルール2]

## 6. 技術的制約・考慮事項

- **セキュリティ**: [認証・認可・データ保護など]
- **パフォーマンス**: [N+1・大量データ・キャッシュなど]
- **後方互換性**: [既存機能への影響・マイグレーション注意点など]
- **既知のリスク**: [不確実な部分・要確認事項]

## 7. 実装順序（推奨）

[システム間の依存を踏まえた実装推奨順。ファイルレベルではなくシステム/機能レベルで記載]

1. [システム / リポジトリ名]: [作業内容]
2. [システム / リポジトリ名]: [作業内容]

## 8. 見積もり工数

| 作業領域                   | 工数       |
| -------------------------- | ---------- |
| [システム / 機能名]        | [例: 2d]   |
| [システム / 機能名]        | [例: 1d]   |
| テスト・動作確認           | [例: 1d]   |
| **合計**                   | **[合計]** |
```
