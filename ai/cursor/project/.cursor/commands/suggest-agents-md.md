# AGENTS.md更新提案コマンド（Cursor用）

**あなたの役割**: 会話履歴を分析し、プロジェクトルートのAGENTS.mdに追記すべき新しいルールやパターンを提案すること。

**重要**: 会話の要約や説明ではなく、「ルールとしてAGENTS.mdに追記する内容の提案」を出力してください。

## 使用方法

```bash
/suggest-agents-md
```

## 分析基準

以下の3つのトリガー条件に該当する内容を検出してください。

### 1. プロジェクト独自のルール

**検出パターン**:

- 「〜ではなく〜を使ってください」
- 「このプロジェクトでは〜のようにしています」
- 標準的なコードを生成後、プロジェクト固有の方法に修正指示

**例**:

- 環境変数の直接参照ではなく、プロジェクト独自の Config モジュールを使ってください
- このプロジェクトではController内でparamsを直接渡さないルールです
- ORMの標準メソッドではなく、既存のfinderメソッドを使ってください

### 2. 同じような修正指示の繰り返し

**検出パターン**:

- 同じ種類の修正指示が2回以上出現
- 類似のコード修正が複数ファイルで発生
- 同じアドバイスが複数回行われた

**例**:

- 複数のテストで同じセットアップ処理の追加を指示
- 複数のコントローラーで同じパターンの修正
- 複数のモデルで同じfinderメソッドの使用を指示

### 3. 関連箇所で揃えるべきパターン

**検出パターン**:

- 「こことここは実装を合わせてください」
- 「Web側とAPI側で統一してください」
- 「通常版とWebView版で揃えてください」
- 関連する複数箇所での統一を指示

**例**:

- 「Web側が `/brands/:brand_id/series` なら、API側も `/api/brands/:brand_id/series` にしてください」
- 「`/xxx`を更新したら、`/webview/xxx`も同様に更新してください」
- 「この画像アップロード処理は他のモデルでも同じパターンで実装してください」

## 出力フォーマット

**必須**: 以下のフォーマットで出力してください。他の形式（要約、報告、説明など）は禁止です。

トリガーに引っかかった場合：

```markdown
会話履歴を分析しました。以下の内容をAGENTS.mdに追記しませんか？

追記した方がよさそうであれば、「この内容をAGENTS.mdに追記してください」のように指示してください。

[提案する具体的な内容]

理由: [プロジェクト独自のルール / 同じような修正指示の繰り返し(N回) / 関連箇所で揃えるべきパターン]
```

トリガーに引っかからなかった場合：

```markdown
会話履歴を分析しました。AGENTS.mdに追記すべき新しい内容は見つかりませんでした。
```

**禁止事項**:

- 「〜を修正しました」「〜を実装しました」などの完了報告形式で書かない
- 会話の要約や説明を出力しない
- 冒頭の「会話履歴を分析しました。」を省略しない

## 提案基準

### 提案する（○）

- プロジェクト全体で共有すべき普遍的なルール
- 技術的な正確性が保証できる内容
- 明確にルール化できる内容
- 今回のコード変更で新しく生まれたパターン

### 提案しない（×）

- 一時的な判断や個別ケースの対応
- 既にAGENTS.mdに記載されている内容
- 個人の好みや一時的な試行
- 不明確または曖昧な指示

## 実行後のアクション

1. 提案内容をレビュー
2. 適切と判断した内容をAGENTS.md（必要に応じて.cursorrules/.cursor/rulesなど他のルールファイル）に追記するように指示
3. コード変更と同じPRに含めてレビュー
4. PRレビューでチームメンバーにレビューしてもらう
